<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>《编写可维护的JavaScript》 | Something here</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="基本的格式化缩进层级TAB或者2个空格、4个空格、8个空格。
建议使用4个空格为一个制表符。">
<meta property="og:type" content="article">
<meta property="og:title" content="《编写可维护的JavaScript》">
<meta property="og:url" content="http://sheilacat.github.io/maintainable-javascript/index.html">
<meta property="og:site_name" content="Something here">
<meta property="og:description" content="基本的格式化缩进层级TAB或者2个空格、4个空格、8个空格。
建议使用4个空格为一个制表符。">
<meta property="og:updated_time" content="2016-10-08T12:26:37.360Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="《编写可维护的JavaScript》">
<meta name="twitter:description" content="基本的格式化缩进层级TAB或者2个空格、4个空格、8个空格。
建议使用4个空格为一个制表符。">
  
    <link rel="alternate" href="/atom.xml" title="Something here" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">

  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Something here</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">This world was never meant for one as beautiful as you.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://sheilacat.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-maintainable-javascript" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/maintainable-javascript/" class="article-date">
  <time datetime="2016-03-23T14:13:07.000Z" itemprop="datePublished">2016-03-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      《编写可维护的JavaScript》
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="基本的格式化"><a href="#基本的格式化" class="headerlink" title="基本的格式化"></a>基本的格式化</h2><h3 id="缩进层级"><a href="#缩进层级" class="headerlink" title="缩进层级"></a>缩进层级</h3><p>TAB或者2个空格、4个空格、8个空格。</p>
<p>建议使用4个空格为一个制表符。</p>
<a id="more"></a>
<h3 id="语句结尾"><a href="#语句结尾" class="headerlink" title="语句结尾"></a>语句结尾</h3><p>有赖于分析器的自动分号插入（Automatic Semicolon Insertion，ASI）机制，JavaScript代码省略分号也是可以正常工作的。ASI会自动寻找代码中应当使用分号但实际没有分号的位置，并插入分号。大多数场景下ASI都会正确插入分号，不会产生错误。但ASI的分号插入规则非常复杂且很难记住，因此我推荐不要省略分号。</p>
<h3 id="行的长度"><a href="#行的长度" class="headerlink" title="行的长度"></a>行的长度</h3><p>80</p>
<h3 id="换行"><a href="#换行" class="headerlink" title="换行"></a>换行</h3><p>运算符后缩进，且增加两个层级的缩进。</p>
<p>逗号是一个运算符，应当作为前一行的行尾。这个换行位置非常重要，因为ASI机制会在某些场景下在行结束的位置插入分号。总是将一个运算符置于行尾，ASI就不会自作主张地插入分号，也就避免了错误的发生。</p>
<p>这个规则有个例外：给变量赋值时</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> result = something + anotherThing + yetAnotherThing + somethingElse +</div><div class="line">                   anotherSomethingElse;</div></pre></td></tr></table></figure>
<h3 id="空行"><a href="#空行" class="headerlink" title="空行"></a>空行</h3><ul>
<li><p>在每个流控制语句之前（比如if和for语句）添加空行。</p>
</li>
<li><p>在方法之间。</p>
</li>
<li><p>在方法中的局部变量和第一条语句之间。</p>
</li>
<li><p>在多行或单行注释之前。</p>
</li>
<li><p>在方法内的逻辑片段之间插入空行，提高可读性。</p>
</li>
</ul>
<h3 id="变量和函数"><a href="#变量和函数" class="headerlink" title="变量和函数"></a>变量和函数</h3><p>命名采用驼峰命名法。变量的前缀是名词，函数前缀是动词。</p>
<h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><p>使用大写字母和下划线来命名，下划线用以分隔单词。</p>
<h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><p>大驼峰命名法。</p>
<h3 id="null"><a href="#null" class="headerlink" title="null"></a>null</h3><p>理解null最好的方式是将它当做对象的占位符（placeholder）。</p>
<h3 id="undefined"><a href="#undefined" class="headerlink" title="undefined"></a>undefined</h3><p>那些没有被初始化的变量都有一个初始值，即undefined，表示这个变量等待被赋值。</p>
<p>通过禁止使用特殊值undefined，可以有效地确保只在一种情况下typeof才会返回“undefined”：当变量未声明时。如果你使用了一个可能赋值为一个对象的变量时，则将其赋值为null。</p>
<p>将变量初始值赋值为null表明了这个变量的意图，它最终很可能赋值为对象。typeof运算符运算null的类型时返回“object”，这样就可以和undefined区分开了。</p>
<h3 id="对象直接量"><a href="#对象直接量" class="headerlink" title="对象直接量"></a>对象直接量</h3><p>这种方式可以取代先显式地创建Object的实例，然后添加属性的这种做法。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// 不好的写法</div><div class="line">var book = new Object();</div><div class="line">book.title = "Maintainable JavaScript;</div><div class="line">book.author = "Nicholas C. Zakas";</div><div class="line">// 好的写法</div><div class="line">var book = &#123;</div><div class="line">     title: "Maintainable JavaScript,</div><div class="line">     author: "Nicholas C. Zakas"</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="数组直接量"><a href="#数组直接量" class="headerlink" title="数组直接量"></a>数组直接量</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不好的写法</span></div><div class="line"><span class="keyword">var</span> colors = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"blue"</span>);</div><div class="line"><span class="comment">// 好的做法</span></div><div class="line"><span class="keyword">var</span> colors = [<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"blue"</span>];</div></pre></td></tr></table></figure>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><h3 id="单行注释"><a href="#单行注释" class="headerlink" title="单行注释"></a>单行注释</h3><p>建议：</p>
<p>斜杠后一个空格</p>
<p>单行注释前有一个空行</p>
<p>缩进到与下一行代码对齐</p>
<p>如果是代码尾部的注释，与代码之间要有一个缩进的距离</p>
<p>最好不要连续使用单行注释</p>
<h3 id="多行注释"><a href="#多行注释" class="headerlink" title="多行注释"></a>多行注释</h3><p>JAVA风格的多行注释：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">* 这是一段注释</div><div class="line">* 第二行</div><div class="line">*/</div></pre></td></tr></table></figure>
<p>代码尾部注释不要用多行注释格式</p>
<h2 id="语句和表达式"><a href="#语句和表达式" class="headerlink" title="语句和表达式"></a>语句和表达式</h2><h3 id="with语句"><a href="#with语句" class="headerlink" title="with语句"></a>with语句</h3><p>with语句用于暂修改作用域链，其语法为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span>(object)&#123;</div><div class="line">    statement </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>width的本意是用来减少键盘的输入的，比如<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj.a = obj.b</div><div class="line">obj.c = obj.d</div></pre></td></tr></table></figure></p>
<p>可以简写成<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span>(obj)&#123;</div><div class="line">     a = b;</div><div class="line">     c = d;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>但是在实际运行时，解释器会首先判断obj.b和obj.d是否存在，如果不存在的话，再判断全局变量b和d是否存在。这样就导致了低效率，而且可能会导致意外，因此最好不要使用with语句。也就是无法知道变量b和d到底是局部变量还是obj的一个属性。实际上这种困惑对开发者的影响更甚，JavaScript引擎和压缩工具无法对这段代码进行优化，因为它们无法猜出代码的正确含义。</p>
<p>在严格模式中，with语句是被明确禁止的。</p>
<h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><p>for循环有两种更改循环执行过程的方法，第一种是break，第二种是continue。</p>
<p>Crockford的编程规范不允许使用continue。他主张代码中与其使用continue不如使用条件语句。更容易理解，且不易出错。可由当前代码可读性决定是否使用。</p>
<h3 id="for-in-循环"><a href="#for-in-循环" class="headerlink" title="for-in 循环"></a>for-in 循环</h3><p><strong><em>for-in循环，不仅遍历对象的实例属性（instance property），同样还遍历从原型继承来的属性。</em></strong>当遍历自定义对象的属性时，往往会因为意外的结果而终止。因此，最好使用<code>hasOwnProperty()</code>方法来为for-in循环过滤出实例属性。</p>
<p>通常for循环用来遍历数组成员，for-in循环用来遍历对象的属性。</p>
<p><strong><em>for-in循环是用来对实例对象和原型链中的键（key）做遍历的，而不是用来遍历包含数字索引的数组的。</em></strong></p>
<h2 id="变量、函数和运算符"><a href="#变量、函数和运算符" class="headerlink" title="变量、函数和运算符"></a>变量、函数和运算符</h2><h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><p>推荐使用单var进行变量的声明。</p>
<h3 id="函数声明"><a href="#函数声明" class="headerlink" title="函数声明"></a>函数声明</h3><p>…</p>
<p>此外，函数声明不应当出现在语句块之内。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不好的写法</span></div><div class="line"><span class="keyword">if</span> (condition) &#123;</div><div class="line">     <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>) </span>&#123;</div><div class="line">          alert(<span class="string">'Hi!'</span>);</div><div class="line">     &#125;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">     <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>) </span>&#123;</div><div class="line">         alert(<span class="string">'Yo!'</span>); </div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>不论condition计算结果如何，大部分浏览器都会使用第二个函数。Firefox会根据计算结果选用合适的函数声明。<br>这种场景是ECMAScript的一个灰色地带，应当尽可能地避免。</p>
<h3 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h3><p>最好不要在全局作用域中使用”use strict”。</p>
<h3 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h3><p>在JavaScript中，<code>eval()</code>的参数是一个字符串，<code>eval()</code>会将传入的字符串当作代码来执行。开发者可以通过这个函数来载入外部的JavaScript代码，或者随即生成代码并执行它。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">eval</span>(<span class="string">"alert('Hi!')"</span>);</div></pre></td></tr></table></figure>
<p>在JavaScript中，<code>eval()</code>并不是唯一可以执行JavaScript字符串的函数，使用Function构造函数、setTimeout()和setInterval也可以。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myfunc = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"alert('Hi!')"</span>);</div><div class="line">setTimeout(<span class="string">"document.body.style.background='red'"</span>, <span class="number">50</span>);</div><div class="line">setInterval(<span class="string">"document.title = 'It is now '"</span> + (<span class="keyword">new</span> <span class="built_in">Date</span>()), <span class="number">1000</span>);</div></pre></td></tr></table></figure>
<p>一个通用的原则是，严禁使用Function，并且只在别无他法时使用eval()。setTimeout()和setInterval也是可以使用的，但不要用字符串形式而要用函数。</p>
<h1 id="编程实践"><a href="#编程实践" class="headerlink" title="编程实践"></a>编程实践</h1><h2 id="避免使用全局变量"><a href="#避免使用全局变量" class="headerlink" title="避免使用全局变量"></a>避免使用全局变量</h2><h3 id="全局变量带来的问题"><a href="#全局变量带来的问题" class="headerlink" title="全局变量带来的问题"></a>全局变量带来的问题</h3><h4 id="命名冲突"><a href="#命名冲突" class="headerlink" title="命名冲突"></a>命名冲突</h4><h4 id="代码的脆弱性"><a href="#代码的脆弱性" class="headerlink" title="代码的脆弱性"></a>代码的脆弱性</h4><h4 id="难以测试"><a href="#难以测试" class="headerlink" title="难以测试"></a>难以测试</h4><h3 id="单全局变量"><a href="#单全局变量" class="headerlink" title="单全局变量"></a>单全局变量</h3><p>*YUI定义了唯一一个YUI全局对象。</p>
<p>*jQuery定义了两个全局对象，$和jQuery。只有在$被其他的类库使用了的情况下，为了避免冲突，应当使用jQuery。</p>
<p>单全局变量的意思是所创建的这个唯一全局对象名是独一无二的（不会和内置API产生冲突），并将你所有的功能代码都挂载到这个全局对象上，因此每个可能的全局变量都成为你唯一全局变量的属性，从而不会创建多个全局变量。</p>
<h3 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h3><h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><h3 id="零全局变量"><a href="#零全局变量" class="headerlink" title="零全局变量"></a>零全局变量</h3><h2 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h2><h3 id="规则1：隔离应用逻辑"><a href="#规则1：隔离应用逻辑" class="headerlink" title="规则1：隔离应用逻辑"></a>规则1：隔离应用逻辑</h3><p>应用逻辑是和应用相关的功能性代码，而不是和用户行为相关的。</p>
<p>将应用逻辑从所有事件处理程序中抽离出来的做法是一种最佳实践。</p>
<p>另一个缺点是和测试有关。测试时需要直接触发功能代码，而不必通过模拟对元素的点击来触发。</p>
<h3 id="规则2：不要分发事件对象"><a href="#规则2：不要分发事件对象" class="headerlink" title="规则2：不要分发事件对象"></a>规则2：不要分发事件对象</h3><p>最佳的办法是让事件处理程序使用event对象来处理事件，然后拿到所有需要的数据传给应用逻辑。</p>
<p>在处理事件时，最好让事件处理程序成为接触到event对象的唯一的函数。事件处理程序应当在进入应用逻辑之前针对event对象执行任何必要的操作，包括阻止默认事件或阻止事件冒泡，都应当直接包含在事件处理程序中。</p>
<p>例如</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> MyApplication = &#123;</div><div class="line">     handleClick: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">          event.preventDefault();</div><div class="line">          event.stopPropagation();</div><div class="line">     </div><div class="line">          <span class="keyword">this</span>.showPopup(event.clientX, event.clientY);</div><div class="line">     &#125;,</div><div class="line"></div><div class="line">     showPopup: <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">          ...</div><div class="line">     &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">addListener(element, <span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">     MyApplication.handleClick(event);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="避免“空比较”"><a href="#避免“空比较”" class="headerlink" title="避免“空比较”"></a>避免“空比较”</h2><h3 id="检查原始值"><a href="#检查原始值" class="headerlink" title="检查原始值"></a>检查原始值</h3><p>5种原型类型：字符串、数字、布尔值、null和undefined。</p>
<p>最佳选择是用typeof运算符。（实际上也只能准确检测undefined）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> num1 = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> num2 = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="keyword">typeof</span> num1; <span class="comment">// "number"</span></div><div class="line"><span class="keyword">typeof</span> num2; <span class="comment">// "object"</span></div><div class="line"></div><div class="line"><span class="keyword">typeof</span> <span class="literal">null</span>; <span class="comment">// "object"</span></div></pre></td></tr></table></figure>
<p>如果要检测null，则直接使用===/!==。</p>
<h3 id="检测引用值"><a href="#检测引用值" class="headerlink" title="检测引用值"></a>检测引用值</h3><p>引用值也称作对象。在JavaScript中除了原始值之外的值都是引用。内置的引用类型：Object、Array、Date和Error。</p>
<p>instanceof，它不仅检测构造这个对象的构造器，还检测原型链。检测自定义类型最好能的做法也是用instanceof运算符。</p>
<h3 id="检测函数"><a href="#检测函数" class="headerlink" title="检测函数"></a>检测函数</h3><p>大部分情况下，用typeof，不用instanceof。instanceof不能“跨帧”。</p>
<h3 id="检测数组"><a href="#检测数组" class="headerlink" title="检测数组"></a>检测数组</h3><p>JavaScript中最古老的跨域问题之一就是在帧之间来回传递数组。instanceof Array在此场景中不总是返回正确的结果。每个帧都会有各自的Array构造函数，因此一个帧中的实例在另外一个帧里不会被识别。</p>
<p>鸭式辨型：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 采用鸭式辨型的方法检测数组</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">     <span class="keyword">return</span> <span class="keyword">typeof</span> value.sort === <span class="string">"function"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这种检测方法依赖一个事实，就是数组是唯一包含sort()方法的对象。</p>
<p>最终，Kangax给出了一种优雅的解决方案：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">     <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(value) === <span class="string">"[object Array]"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ECMAScript5将Array.isArray()正式引入JavaScript。</p>
<h3 id="检测属性"><a href="#检测属性" class="headerlink" title="检测属性"></a>检测属性</h3><p>因为存在IE8以及更早版本IE的情形（在调用DOM对象的hasOwnProperty方法之前应当先检测其是否存在），在判断实例对象是否存在时，更倾向于使用in运算符，只有在需要判断实例属性时才会用到hasOwnProperty()。</p>
<h2 id="将配置数据从代码中分离出来"><a href="#将配置数据从代码中分离出来" class="headerlink" title="将配置数据从代码中分离出来"></a>将配置数据从代码中分离出来</h2><h3 id="什么是配置数据"><a href="#什么是配置数据" class="headerlink" title="什么是配置数据"></a>什么是配置数据</h3><p>*URL</p>
<p>*需要展现给用户的字符串</p>
<p>*重复的值</p>
<p>*设置（比如每页的配置项）</p>
<p>*任何可能发生变更的值</p>
<h3 id="抽离配置数据"><a href="#抽离配置数据" class="headerlink" title="抽离配置数据"></a>抽离配置数据</h3><h3 id="保存配置数据"><a href="#保存配置数据" class="headerlink" title="保存配置数据"></a>保存配置数据</h3><p>*java属性文件等进行保存</p>
<p>然后将这个文件转换为JavaScript可用的额文件：</p>
<p>*JSON</p>
<p>*JSONP</p>
<p>*纯JavaScript</p>
<h2 id="抛出自定义错误"><a href="#抛出自定义错误" class="headerlink" title="抛出自定义错误"></a>抛出自定义错误</h2><h3 id="try-catch语句"><a href="#try-catch语句" class="headerlink" title="try-catch语句"></a>try-catch语句</h3><h3 id="错误类型"><a href="#错误类型" class="headerlink" title="错误类型"></a>错误类型</h3><h4 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h4><p>所有错误的基本类型。实际上引擎从来不会抛出该类型的错误。</p>
<h4 id="EvalError"><a href="#EvalError" class="headerlink" title="EvalError"></a>EvalError</h4><p>通过eval()函数执行代码发生错误时抛出。</p>
<h4 id="RangeError"><a href="#RangeError" class="headerlink" title="RangeError"></a>RangeError</h4><p>一个数字超过它的边界时抛出。</p>
<h4 id="ReferenceError"><a href="#ReferenceError" class="headerlink" title="ReferenceError"></a>ReferenceError</h4><p>期望的对象不存在时抛出。引用错误。</p>
<h4 id="SyntaxError"><a href="#SyntaxError" class="headerlink" title="SyntaxError"></a>SyntaxError</h4><p>给eval()函数传递的代码中有语法错误时。</p>
<h4 id="TypeError"><a href="#TypeError" class="headerlink" title="TypeError"></a>TypeError</h4><p>变量不是期望的类型时抛出。</p>
<h4 id="URIError"><a href="#URIError" class="headerlink" title="URIError"></a>URIError</h4><p>给encodeURI()、encodeURIComponent()、decodeURI()或者decodeURIComponent()等函数传递格式非法的URI字符串时抛出。</p>
<h1 id="不是你的对象不要动"><a href="#不是你的对象不要动" class="headerlink" title="不是你的对象不要动"></a>不是你的对象不要动</h1><h2 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h2><p>针对原生对象、DOM对象、浏览器对象模型（BOM）对象、类库对象</p>
<h3 id="不覆盖方法"><a href="#不覆盖方法" class="headerlink" title="不覆盖方法"></a>不覆盖方法</h3><h3 id="不新增方法"><a href="#不新增方法" class="headerlink" title="不新增方法"></a>不新增方法</h3><h3 id="不删除方法"><a href="#不删除方法" class="headerlink" title="不删除方法"></a>不删除方法</h3><h2 id="更好的途径"><a href="#更好的途径" class="headerlink" title="更好的途径"></a>更好的途径</h2><h3 id="基于对象的继承"><a href="#基于对象的继承" class="headerlink" title="基于对象的继承"></a>基于对象的继承</h3><p>Object.create()</p>
<h3 id="基于类型的继承"><a href="#基于类型的继承" class="headerlink" title="基于类型的继承"></a>基于类型的继承</h3><p>首先，原型继承；然后，构造器继承。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">     <span class="keyword">this</span>.name;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Author</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">     Person.call(<span class="keyword">this</span>, name); <span class="comment">//继承构造器</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">Author.prototype = <span class="keyword">new</span> Person();</div></pre></td></tr></table></figure>
<h3 id="门面模式"><a href="#门面模式" class="headerlink" title="门面模式"></a>门面模式</h3><p>门面模式，也叫做包装器。它为一个已存在的对象创建一个新的接口。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">DOMWrapper</span>(<span class="params">element</span>) </span>&#123; </div><div class="line">     <span class="keyword">this</span>.element = element;</div><div class="line">&#125;</div><div class="line"></div><div class="line">DOMWrapper.prototype.addClass = <span class="function"><span class="keyword">function</span>(<span class="params">className</span>) </span>&#123;</div><div class="line">     element.className += <span class="string">" "</span> + className;</div><div class="line">&#125;</div><div class="line"></div><div class="line">DOMWrapper.prototype.remove = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="keyword">this</span>.element.parentNode.removeChild(<span class="keyword">this</span>.element);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> wrapper = <span class="keyword">new</span> DOMWrapper(<span class="built_in">document</span>.getElementById(<span class="string">"my-div"</span>));</div><div class="line">wrapper.addClass(<span class="string">"selected"</span>);</div><div class="line">wrapper.remove();</div></pre></td></tr></table></figure>
<h3 id="关于Polyfill的注解"><a href="#关于Polyfill的注解" class="headerlink" title="关于Polyfill的注解"></a>关于Polyfill的注解</h3><p>Polyfills也称为shims，是指一种功能的模拟，模拟一些新版本中新特性的原生功能并且要以完全兼容的方式实现。</p>
<p>从维护角度说，最好使用门面模式来代替polyfill。</p>
<h3 id="阻止修改"><a href="#阻止修改" class="headerlink" title="阻止修改"></a>阻止修改</h3><p>三种锁定修改的级别：</p>
<h4 id="防止扩展"><a href="#防止扩展" class="headerlink" title="防止扩展"></a>防止扩展</h4><p>禁止添加，但可以删除和修改。</p>
<p>Object.preventExtension()，防止扩展。Object.isExtensible()，检测是否可拓展。</p>
<h4 id="密封"><a href="#密封" class="headerlink" title="密封"></a>密封</h4><p>禁止添加和删除，但可以修改。</p>
<p>Object.seal()<br>Object.isSealed()</p>
<h4 id="冻结"><a href="#冻结" class="headerlink" title="冻结"></a>冻结</h4><p>禁止删除和添加、修改，只读模式。</p>
<p>Object.freeze()<br>Object.isFrozen()</p>
<p>以上三种模式中，当操作禁止行为时会静默失败，只有在严格模式下才会报错。</p>
<p>一旦一个对象被锁定了，将无法解锁。</p>
<h2 id="浏览器嗅探"><a href="#浏览器嗅探" class="headerlink" title="浏览器嗅探"></a>浏览器嗅探</h2><h2 id="自动化"><a href="#自动化" class="headerlink" title="自动化"></a>自动化</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://sheilacat.github.io/maintainable-javascript/" data-id="ciww2og180012useqro0nleab" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/Coffeescript-minibook/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          《Coffeescript小书》笔记
        
      </div>
    </a>
  
  
    <a href="/learn-git/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">git学习笔记</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
	<h3 class="widget-title">PROFILE</h3>
	<div class="widget">
		<div class="profile">
			<img class="profile" />
		  	<p>SHEILACAT</p>
		  	<span>You said you grow old with me.</span>
		  	<p class="link">
		  		<a class="me-github" target="_blank" href="https://github.com/sheilaCat"></a>
			  	<a class="me-weibo" href="#"></a>
			  	<a class="me-zhihu" target="_blank" href="https://www.zhihu.com/people/sheilaCat"></a>
	  	        
	  	        	<a class="me-rss" href="/atom.xml"></a>
		        
		  	</p>
	  		<div class="tags">
	  			<span>这个杀手不太冷</span>
	  			<span>叔本华迷妹</span>
	  			<span>前端攻城狮</span>
	  			<span>可能是个萌妹子</span>
	  		</div>
		</div>
	</div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/weixin-tiny-program/">微信小程序概念及实践</a>
          </li>
        
          <li>
            <a href="/node-straight-out/">node直出与同构javascript</a>
          </li>
        
          <li>
            <a href="/learn-es6/">ECMAScript6学习</a>
          </li>
        
          <li>
            <a href="/javascript-error-handle/">JavaScript错误处理</a>
          </li>
        
          <li>
            <a href="/create-an-object/">面向对象的程序设计——创建对象</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Coffeescript/">Coffeescript</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端技术/">前端技术</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端规范化/">前端规范化</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/浏览器相关/">浏览器相关</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络知识/">网络知识</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>


  
    <div class="widget-wrap">
	<h3 class="widget-title">FRIENDS</h3>
	<div class="widget">
		<a href="http://blog.chenzuhuang.com/">祖神的博客</a>
	</div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 SheilaCat<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>